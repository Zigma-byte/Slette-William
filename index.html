<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Slette William</title>
<link rel="icon" type="image/x-icon" href="./lw.png">
<style>
  :root { --ui-bg:#fff; --ui-border:#000; }
  html,body{height:100%}
  body{margin:0;background:#f7f7f7;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;overflow:hidden}
  .settings{position:fixed;top:0;left:0;width:100%;background:var(--ui-bg);border-bottom:2px solid var(--ui-border);padding:10px;display:flex;flex-wrap:wrap;gap:10px;z-index:10;box-sizing:border-box;align-items:center}
  .settings label{display:flex;flex-direction:column;font-size:14px;min-width:160px}
  input[type=range]{width:150px}
  canvas{display:block;position:absolute;top:120px;left:0;width:100%;height:calc(100vh - 120px)}
  #pauseMenu,#gameOverMenu{position:fixed;top:120px;left:0;width:100%;height:calc(100vh - 120px);background:rgba(0,0,0,0.7);color:white;display:none;justify-content:center;align-items:center;z-index:20}
  #pauseMenu div,#gameOverMenu div{text-align:center}
  #pauseMenu button,#gameOverMenu button{margin:10px;padding:10px 20px;font-size:16px;cursor:pointer}
  @media(max-width:600px){.settings{gap:8px;padding:8px}.settings label{min-width:120px;font-size:12px}}
</style>
</head>
<body>
<div class="settings">
  <label>Cactus Spawn Frequency (ms)<input type="range" min="400" max="2000" id="spawnFreq"><span id="spawnFreqVal"></span></label>
  <label>William's Speed<input type="range" min="2" max="20" id="dinoSpeed"><span id="dinoSpeedVal"></span></label>
  <label>Jump Power<input type="range" min="6" max="20" id="jumpPower"><span id="jumpPowerVal"></span></label>
  <label>Gravity<input type="range" min="0.2" max="5" step="0.1" id="gravity"><span id="gravityVal"></span></label>
  <label>Passive Score Rate (+points/sec)<input type="range" min="0" max="10" step="0.05" id="scoreRate"><span id="scoreRateVal"></span></label>
  <label>Hard Jump Chance (%)<input type="range" min="0" max="100" id="hardJump"><span id="hardJumpVal"></span></label>
  <label>Character Hitbox Height<input type="range" min="0" max="100" id="hitHeight"><span id="hitHeightVal"></span></label>
  <button id="resetSettings">Reset Settings</button>
</div>
<canvas id="gameCanvas"></canvas>
<div id="pauseMenu"><div><h2>Game Paused</h2><button onclick="resumeGame()">Resume</button><button onclick="restartGame()">Restart</button></div></div>
<div id="gameOverMenu"><div><h2 id="gameOverText">Game Over!</h2><p id="finalScore"></p><button onclick="restartGame()">Restart</button></div></div>

<script>
const canvas=document.getElementById("gameCanvas"),ctx=canvas.getContext("2d");
function resizeCanvas(){canvas.width=window.innerWidth;canvas.height=window.innerHeight-120}resizeCanvas();window.addEventListener("resize",resizeCanvas);
const dinoImg=new Image(),cacImg=new Image(),jetImg=new Image();dinoImg.src="./lw.png";cacImg.src="./cac.png";jetImg.src="./fw.png";
const passSound=new Audio("./sound.mp3"),milestoneSound=new Audio("./over.mp3"),background1=new Audio("./back.mp3"),background2=new Audio("./back2.mp3"),background3=new Audio("./end.mp3");
background1.volume=background2.volume=.4;background3.volume=.6;
const settings={spawnFreq:spawnFreq,dinoSpeed:dinoSpeed,jumpPower:jumpPower,gravity:gravity,scoreRate:scoreRate,hardJump:hardJump,hitHeight:hitHeight};
const displays={spawnFreqVal:spawnFreqVal,dinoSpeedVal:dinoSpeedVal,jumpPowerVal:jumpPowerVal,gravityVal:gravityVal,scoreRateVal:scoreRateVal,hardJumpVal:hardJumpVal,hitHeightVal:hitHeightVal};
const defaults={spawnFreq:1000,dinoSpeed:6,jumpPower:12,gravity:.6,scoreRate:.2,hardJump:12.5,hitHeight:20};
for(let k in settings){settings[k].value=localStorage.getItem(k)||defaults[k];displays[k+"Val"].textContent=settings[k].value;settings[k].addEventListener("input",()=>{displays[k+"Val"].textContent=settings[k].value;localStorage.setItem(k,settings[k].value);if(k==="hitHeight")dino.hitHeight=parseFloat(settings.hitHeight.value)})}
resetSettings.onclick=()=>{for(let k in defaults)localStorage.setItem(k,defaults[k]);location.reload()};
let dino={x:50,y:-10,width:60,height:70,hitHeight:parseFloat(settings.hitHeight.value),dy:0,isJumping:false};
let cactuses=[],jets=[],fallingCactuses=[],score=0,highScore=localStorage.getItem("highScore")||0,normalHighScore=localStorage.getItem("normalHighScore")||0,moddedHighScore=localStorage.getItem("moddedHighScore")||0,gameOver=false,paused=false,cactusTimer=null,jetsUnlocked=false,pendingBounce=null,lastMilestone=0;
const ground=()=>canvas.height-80;
function isDefaultSettings(){for(let k in defaults){if(Math.abs(parseFloat(settings[k].value)-defaults[k])>1e-3)return false}return true}
function drawDino(){ctx.drawImage(dinoImg,dino.x,dino.y,dino.width,dino.height)}function drawCactus(c){ctx.drawImage(cacImg,c.x,c.y,c.width,c.height)}
function spawnCactus(){if(paused||gameOver)return;let w=Math.random()*20+20,h=Math.random()*40+40,g=Math.random()*200+400;if(Math.random()*100<parseFloat(settings.hardJump.value)){let f={x:canvas.width+g,y:ground()+(60-h),width:w,height:h};let s={x:f.x+f.width+Math.random()*10+10,y:ground()+(60-h),width:w,height:h};cactuses.push(f,s)}else cactuses.push({x:canvas.width+g,y:ground()+(60-h),width:w,height:h});cactusTimer=setTimeout(spawnCactus,Math.random()*700+parseFloat(settings.spawnFreq.value))}
function spawnJet(){if(paused||gameOver)return;jets.push({x:-100,y:Math.random()*90+20,width:100,height:60,speed:4,dropCooldown:Math.random()*80+30,spawnTime:Date.now()});setTimeout(spawnJet,Math.random()*5e3+5e3)}
function updateJets(){for(let i=0;i<jets.length;i++){let j=jets[i];j.x+=j.speed;if(Date.now()-j.spawnTime>450){j.dropCooldown--;if(j.dropCooldown<=0){fallingCactuses.push({x:j.x+j.width/2-10,y:j.y+j.height,width:20,height:40,dy:5,dx:-.2-Math.random()*5});j.dropCooldown=Math.random()*60+25}}if(j.x>canvas.width+100){jets.splice(i,1);i--}else ctx.drawImage(jetImg,j.x,j.y,j.width,j.height)}for(let i=0;i<fallingCactuses.length;i++){let f=fallingCactuses[i];f.y+=f.dy;f.x+=f.dx;ctx.drawImage(cacImg,f.x,f.y,f.width,f.height);if(dino.hitHeight>0&&dino.x<f.x+f.width&&dino.x+dino.width>f.x&&dino.y<f.y+f.height&&dino.y+dino.hitHeight>f.y){if(!pendingBounce)pendingBounce={time:Date.now(),cactus:f}}if(f.y>canvas.height+50||f.x+f.width<0){fallingCactuses.splice(i,1);i--}}}
function handleGameOver(){gameOver=true;if(score>highScore){highScore=score;localStorage.setItem("highScore",highScore)}if(isDefaultSettings()&&score>normalHighScore){normalHighScore=score;localStorage.setItem("normalHighScore",normalHighScore)}else if(!isDefaultSettings()&&score>moddedHighScore){moddedHighScore=score;localStorage.setItem("moddedHighScore",moddedHighScore)}finalScore.textContent="Final Score: "+Math.floor(score);gameOverMenu.style.display="flex"}
function update(){ctx.clearRect(0,0,canvas.width,canvas.height);if(!paused&&!gameOver){dino.y+=dino.dy;if(dino.y+dino.height<canvas.height)dino.dy+=parseFloat(settings.gravity.value);if(dino.y>=ground()){dino.y=ground();dino.dy=0;dino.isJumping=false}for(let i=0;i<cactuses.length;i++){let c=cactuses[i];c.x-=parseFloat(settings.dinoSpeed.value);drawCactus(c);if(dino.hitHeight>0&&dino.x<c.x+c.width&&dino.x+dino.width>c.x&&dino.y<c.y+c.height&&dino.y+dino.hitHeight>c.y)handleGameOver();if(c.x+c.width<0){cactuses.splice(i,1);passSound.currentTime=0;passSound.play();score++;i--}}drawDino();if(!jetsUnlocked&&score>20){jetsUnlocked=true;spawnJet()}if(jetsUnlocked)updateJets();if(pendingBounce&&Date.now()-pendingBounce.time>1e3)handleGameOver();ctx.fillStyle="black";ctx.font="20px Arial";ctx.fillText("Score: "+Math.floor(score),canvas.width-250,30);ctx.fillText("High Score: "+Math.floor(highScore),canvas.width-250,55);ctx.fillText("Normal High: "+Math.floor(normalHighScore),canvas.width-250,80);ctx.fillText("Modded High: "+Math.floor(moddedHighScore),canvas.width-250,105);if(score>=300)triggerSecretEnding()}requestAnimationFrame(update)}
setInterval(()=>{if(!paused&&!gameOver){score+=parseFloat(settings.scoreRate.value)*.5;let f=Math.floor(score);if(f%10===0&&f!==lastMilestone){milestoneSound.currentTime=0;milestoneSound.play();lastMilestone=f}}},500);
function jump(){if(pendingBounce){dino.dy=-parseFloat(settings.jumpPower.value);dino.isJumping=true;pendingBounce=null}else if(!dino.isJumping){dino.dy=-parseFloat(settings.jumpPower.value);dino.isJumping=true}}
function togglePause(){paused=!paused;pauseMenu.style.display=paused?"flex":"none"}function resumeGame(){paused=false;pauseMenu.style.display="none"}
function restartGame(){clearTimeout(cactusTimer);score=0;gameOver=false;paused=false;cactuses=[];jets=[];fallingCactuses=[];jetsUnlocked=false;dino.y=-10;dino.dy=0;dino.isJumping=false;pendingBounce=null;lastMilestone=0;pauseMenu.style.display="none";gameOverMenu.style.display="none";spawnCactus()}
document.addEventListener("keydown",e=>{if(e.code==="Space"){jump();if(!musicPlaying)playRandomTrack()}if(e.code==="KeyP")togglePause()});
canvas.addEventListener("click",()=>{jump();if(!musicPlaying)playRandomTrack()});
canvas.addEventListener("touchstart",e=>{e.preventDefault();jump();if(!musicPlaying)playRandomTrack()},{passive:false});
dinoImg.onload=()=>{update();spawnCactus()};
let musicPlaying=false;function playRandomTrack(){musicPlaying=true;background1.pause();background2.pause();background1.currentTime=0;background2.currentTime=0;let p=Math.random()<.5?background1:background2;p.play();p.onended=()=>{musicPlaying=false;playRandomTrack()}}
function triggerSecretEnding(){[endingVictory,endingUfo,endingSunset][Math.floor(Math.random()*3)]()}
function endingVictory(){gameOver=true;background1.pause();background2.pause();background3.play();ctx.fillStyle="gold";ctx.font="50px Arial";ctx.fillText("You Win!",canvas.width/2-100,canvas.height/2);setTimeout(()=>gameOverMenu.style.display="flex",2000)}
function endingUfo(){gameOver=true;ctx.fillStyle="lime";ctx.font="40px Arial";ctx.fillText("Abducted by UFO!",canvas.width/2-150,canvas.height/2);setTimeout(()=>gameOverMenu.style.display="flex",2000)}
function endingSunset(){gameOver=true;ctx.fillStyle="orange";ctx.font="40px Arial";ctx.fillText("Peaceful Sunset Ending",canvas.width/2-200,canvas.height/2);setTimeout(()=>gameOverMenu.style.display="flex",2000)}
</script>
</body>
</html>
